# Ù…Ø³ØªÙ†Ø¯Ø§Øª ÙÙ†ÛŒ Ú©Ø§Ù…Ù„ - SEDE
## Ù†Ù…ÙˆÙ†Ù‡ Ø§Ø¬Ø±Ø§ÛŒ Ú©Ø§Ù…Ù„ Ø³ÛŒØ³ØªÙ… Ø¨Ø§ Ø¬Ø²Ø¦ÛŒØ§Øª Ù¾ÛŒØ´Ø±ÙØªÙ‡

<div dir="rtl">

---

## ğŸ“‹ ÙÙ‡Ø±Ø³Øª Ù…Ø·Ø§Ù„Ø¨

1. [Ù…Ù‚Ø¯Ù…Ù‡](#Ù…Ù‚Ø¯Ù…Ù‡)
2. [Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ù†Ù…ÙˆÙ†Ù‡ Ú©Ø§Ø±Ø¨Ø±](#Ø¯Ø±Ø®ÙˆØ§Ø³Øª-Ù†Ù…ÙˆÙ†Ù‡-Ú©Ø§Ø±Ø¨Ø±)
3. [Ù…Ø±Ø­Ù„Ù‡ 1: Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø§ÙˆÙ„ÛŒÙ‡ Ú†Øªâ€ŒØ¨Ø§Øª](#Ù…Ø±Ø­Ù„Ù‡-1-Ù¾Ø±Ø¯Ø§Ø²Ø´-Ø§ÙˆÙ„ÛŒÙ‡-Ú†Øªâ€ŒØ¨Ø§Øª)
4. [Ù…Ø±Ø­Ù„Ù‡ 2: Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…ÙˆØ¬ÙˆØ¯ÛŒØªâ€ŒÙ‡Ø§](#Ù…Ø±Ø­Ù„Ù‡-2-Ø§Ø³ØªØ®Ø±Ø§Ø¬-Ù…ÙˆØ¬ÙˆØ¯ÛŒØªâ€ŒÙ‡Ø§)
5. [Ù…Ø±Ø­Ù„Ù‡ 3: Ø·Ø¨Ù‚Ù‡â€ŒØ¨Ù†Ø¯ÛŒ Ù…Ù‚ØµÙˆØ¯](#Ù…Ø±Ø­Ù„Ù‡-3-Ø·Ø¨Ù‚Ù‡â€ŒØ¨Ù†Ø¯ÛŒ-Ù…Ù‚ØµÙˆØ¯)
6. [Ù…Ø±Ø­Ù„Ù‡ 4: ØªÙˆÙ„ÛŒØ¯ Ú©ÙˆØ¦Ø±ÛŒ Ø³Ø§Ø®ØªØ§Ø±ÛŒØ§ÙØªÙ‡](#Ù…Ø±Ø­Ù„Ù‡-4-ØªÙˆÙ„ÛŒØ¯-Ú©ÙˆØ¦Ø±ÛŒ-Ø³Ø§Ø®ØªØ§Ø±ÛŒØ§ÙØªÙ‡)
7. [Ù…Ø±Ø­Ù„Ù‡ 5: Ø§Ø¬Ø±Ø§ÛŒ Ø®Ø²Ù†Ø¯Ù‡](#Ù…Ø±Ø­Ù„Ù‡-5-Ø§Ø¬Ø±Ø§ÛŒ-Ø®Ø²Ù†Ø¯Ù‡)
8. [Ù…Ø±Ø­Ù„Ù‡ 6: Ù†Ø±Ù…Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§](#Ù…Ø±Ø­Ù„Ù‡-6-Ù†Ø±Ù…Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ-Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§)
9. [Ù†ØªØ§ÛŒØ¬ Ù†Ù‡Ø§ÛŒÛŒ](#Ù†ØªØ§ÛŒØ¬-Ù†Ù‡Ø§ÛŒÛŒ)
10. [Ù†Ù…ÙˆØ¯Ø§Ø± Ø¬Ø±ÛŒØ§Ù† Ú©Ø§Ù…Ù„](#Ù†Ù…ÙˆØ¯Ø§Ø±-Ø¬Ø±ÛŒØ§Ù†-Ú©Ø§Ù…Ù„)

---

## ğŸ¯ Ù…Ù‚Ø¯Ù…Ù‡

Ø§ÛŒÙ† Ù…Ø³ØªÙ†Ø¯Ø§Øª Ù†Ø´Ø§Ù† Ù…ÛŒâ€ŒØ¯Ù‡Ø¯ Ú©Ù‡ Ú†Ú¯ÙˆÙ†Ù‡ Ø³ÛŒØ³ØªÙ… SEDE ÛŒÚ© Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ù¾ÛŒÚ†ÛŒØ¯Ù‡ Ú©Ø§Ø±Ø¨Ø± Ø±Ø§ Ù¾Ø±Ø¯Ø§Ø²Ø´ Ú©Ø±Ø¯Ù‡ Ùˆ Ø¨Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù‚Ø§Ø¨Ù„ Ø§Ø³ØªÙØ§Ø¯Ù‡ ØªØ¨Ø¯ÛŒÙ„ Ù…ÛŒâ€ŒÚ©Ù†Ø¯.

### Ù…Ø¹Ù…Ø§Ø±ÛŒ Ú©Ù„ÛŒ

```
User Input â†’ Chatbot Engine â†’ NLU Processing â†’ Query Generation â†’ Crawler Execution â†’ Data Normalization â†’ Results
```

---

## ğŸ“ Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ù†Ù…ÙˆÙ†Ù‡ Ú©Ø§Ø±Ø¨Ø±

### ÙˆØ±ÙˆØ¯ÛŒ Ø§ØµÙ„ÛŒ

```
Ø³Ù„Ø§Ù… Ù…Ù† 600 Ù…ÛŒÙ„ÛŒÙˆÙ† Ù†Ù‚Ø¯ Ø¯Ø§Ø±Ù… Ùˆ Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ù… 200 Ù…ÛŒÙ„ÛŒÙˆÙ† Ù‡Ù… ÙˆØ§Ù… Ø¨Ú¯ÛŒØ±Ù… ØªØ§ 2 Ù…Ø§Ù‡ Ø¢ÛŒÙ†Ø¯Ù‡ Ø¨Ù‡ Ø¯Ø³ØªÙ… Ø¨Ø±Ø³Ø¯.
Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡Ù… Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†Ù… Ø¨Ø§ Ø§ÛŒÙ† Ù…Ø¨Ù„Øº Ø®Ø§Ù†Ù‡ Ø¯Ø± ØªÙ‡Ø±Ø§Ù† Ø§Ú©Ø¨Ø§ØªØ§Ù† Ø±Ù‡Ù† Ú©Ù†Ù….
Ø§Ú¯Ø± Ù†Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ù… Ø¯Ø± Ú©Ø¯Ø§Ù… Ù…Ù†Ø·Ù‚Ù‡ Ù…Ù†Ø§Ø³Ø¨ Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ù… Ù…Ù†Ø²Ù„ Ø¨Ø±Ø§ÛŒ Ø±Ù‡Ù† Ù¾ÛŒØ¯Ø§ Ú©Ù†Ù….
Ù‡Ù…Ú†Ù†ÛŒÙ† Ø§Ú¯Ø± Ù¾ÙˆÙ„ Ù…Ù† Ù†Ù…ÛŒâ€ŒØ±Ø³Ø¯ Ø¨Ø±Ø§ÛŒ Ù…Ø§Ø´ÛŒÙ† Ú†Ø·ÙˆØ± Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ù… Ù…Ø§Ø´ÛŒÙ† Ù…Ù†Ø§Ø³Ø¨ÛŒ Ø¨Ø§ Ø§ÛŒÙ† Ù…Ø¨Ù„Øº ØªÙ‡ÛŒÙ‡ Ú©Ù†Ù….
Ù‡Ù…Ú†Ù†ÛŒÙ† Ú†Ù‡ Ø¨Ø±Ø§ÛŒ Ø§Ø¬Ø§Ø±Ù‡ Ùˆ Ú†Ù‡ Ø¨Ø±Ø§ÛŒ Ù‚Ø³Ø· Ù…Ø§Ø´ÛŒÙ† Ù„ÛŒØ²ÛŒÙ†Ú¯ Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ù… Ù…Ø§Ù‡ÛŒ 15 Ù…ÛŒÙ„ÛŒÙˆÙ† Ø¨Ø¯Ù‡Ù… Ø¨Ø¬Ø² Ù†Ù‚Ø¯ÛŒÙ†Ú¯ÛŒ Ùˆ Ù…Ø¨Ù„Øº ÙˆØ§Ù…Ù….
```

### ØªØ­Ù„ÛŒÙ„ Ø§ÙˆÙ„ÛŒÙ‡ Ø¯Ø±Ø®ÙˆØ§Ø³Øª

- **Ù†Ù‚Ø¯ÛŒÙ†Ú¯ÛŒ**: 600 Ù…ÛŒÙ„ÛŒÙˆÙ† ØªÙˆÙ…Ø§Ù†
- **ÙˆØ§Ù…**: 200 Ù…ÛŒÙ„ÛŒÙˆÙ† ØªÙˆÙ…Ø§Ù† (2 Ù…Ø§Ù‡ Ø¢ÛŒÙ†Ø¯Ù‡)
- **ØªÙˆØ§Ù† Ù¾Ø±Ø¯Ø§Ø®Øª Ù…Ø§Ù‡ÛŒØ§Ù†Ù‡**: 15 Ù…ÛŒÙ„ÛŒÙˆÙ† ØªÙˆÙ…Ø§Ù†
- **Ø§Ù‡Ø¯Ø§Ù**: 
  1. Ø±Ù‡Ù† Ø®Ø§Ù†Ù‡ Ø¯Ø± Ø§Ú©Ø¨Ø§ØªØ§Ù† (Ø§ÙˆÙ„ÙˆÛŒØª Ø¨Ø§Ù„Ø§)
  2. Ø±Ù‡Ù† Ø®Ø§Ù†Ù‡ Ø¯Ø± Ù…Ù†Ø·Ù‚Ù‡ Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ† (Ø§ÙˆÙ„ÙˆÛŒØª Ù…ØªÙˆØ³Ø·)
  3. Ø®Ø±ÛŒØ¯ ÛŒØ§ Ù„ÛŒØ²ÛŒÙ†Ú¯ Ø®ÙˆØ¯Ø±Ùˆ (Ø§ÙˆÙ„ÙˆÛŒØª Ø¨Ø§Ù„Ø§)

---

## ğŸ”„ Ù…Ø±Ø­Ù„Ù‡ 1: Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø§ÙˆÙ„ÛŒÙ‡ Ú†Øªâ€ŒØ¨Ø§Øª

### Ú©Ù„Ø§Ø³: `ChatbotEngine`

```python
# ÙØ§ÛŒÙ„: src/chatbot/engine.py

class ChatbotEngine:
    def process_message(self, message: str, session_id: str = None):
        # Step 1.1: Ø¯Ø±ÛŒØ§ÙØª Ù¾ÛŒØ§Ù… Ú©Ø§Ø±Ø¨Ø±
        user_message = message
        
        # Step 1.2: Ø§Ø³ØªØ®Ø±Ø§Ø¬ context Ø§Ø² session (Ø§Ú¯Ø± ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ø¯)
        context = self._get_conversation_context(session_id)
        
        # Step 1.3: Ø§Ø±Ø³Ø§Ù„ Ø¨Ù‡ NLU Processor
        nlu_result = self.nlu_processor.process(message, context)
```

### Ø®Ø±ÙˆØ¬ÛŒ Ù…Ø±Ø­Ù„Ù‡ 1

```json
{
  "message_received": true,
  "session_id": "user_session_12345",
  "message_length": 287,
  "timestamp": "2024-11-15T10:30:00"
}
```

---

## ğŸ” Ù…Ø±Ø­Ù„Ù‡ 2: Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…ÙˆØ¬ÙˆØ¯ÛŒØªâ€ŒÙ‡Ø§

### Ú©Ù„Ø§Ø³: `EntityExtractor`

```python
# ÙØ§ÛŒÙ„: src/chatbot/entity_extractor.py

class EntityExtractor:
    def extract_all_entities(self, text: str):
        # Step 2.1: Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…ÙˆØ¬ÙˆØ¯ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ù¾ÙˆÙ„ÛŒ
        money_entities = self.extract_money_entities(text)
        # Result: [600 Ù…ÛŒÙ„ÛŒÙˆÙ†, 200 Ù…ÛŒÙ„ÛŒÙˆÙ†, 15 Ù…ÛŒÙ„ÛŒÙˆÙ†]
        
        # Step 2.2: Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ø·Ù„Ø§Ø¹Ø§Øª ÙˆØ§Ù…
        loan_amount, loan_months = self.extract_loan_info(text)
        # Result: (200.0, 2)
        
        # Step 2.3: Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù¾Ø±Ø¯Ø§Ø®Øª Ù…Ø§Ù‡ÛŒØ§Ù†Ù‡
        monthly_payment = self.extract_monthly_payment(text)
        # Result: 15.0
        
        # Step 2.4: Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…Ú©Ø§Ù†â€ŒÙ‡Ø§
        locations = self.extract_location(text)
        # Result: ["ØªÙ‡Ø±Ø§Ù†", "Ø§Ú©Ø¨Ø§ØªØ§Ù†"]
        
        # Step 2.5: Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù†ÙˆØ¹ Ø¬Ø³ØªØ¬Ùˆ
        search_type = self.extract_search_type(text)
        # Result: {"type": "residential_rent", "search_type": "Ø±Ù‡Ù† Ú©Ø§Ù…Ù„"}
```

### Ø¬Ø²Ø¦ÛŒØ§Øª Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…ÙˆØ¬ÙˆØ¯ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ù¾ÙˆÙ„ÛŒ

#### Ø§Ù„Ú¯ÙˆÙ‡Ø§ÛŒ Regex Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø´Ø¯Ù‡:

```python
money_patterns = [
    r'(\d+(?:\.\d+)?)\s*(?:Ù…ÛŒÙ„ÛŒÙˆÙ†|Ù…Ù„ÛŒÙˆÙ†|Ù…|M)\s*(?:ØªÙˆÙ…Ø§Ù†|ØªÙˆÙ…Ù†)?',
    r'(\d+(?:\.\d+)?)\s*(?:Ù‡Ø²Ø§Ø±|k)\s*(?:ØªÙˆÙ…Ø§Ù†|ØªÙˆÙ…Ù†)?',
    r'(\d+(?:\.\d+)?)\s*(?:Ù…ÛŒÙ„ÛŒØ§Ø±Ø¯|Ø¨ÛŒÙ„ÛŒÙˆÙ†|b)\s*(?:ØªÙˆÙ…Ø§Ù†|ØªÙˆÙ…Ù†)?',
]
```

#### Ù†ØªØ§ÛŒØ¬ Ø§Ø³ØªØ®Ø±Ø§Ø¬:

| Ù…ÙˆØ¬ÙˆØ¯ÛŒØª | Ù…Ù‚Ø¯Ø§Ø± Ø®Ø§Ù… | Ù…Ù‚Ø¯Ø§Ø± Ù†Ø±Ù…Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Ø´Ø¯Ù‡ | Ù…ÙˆÙ‚Ø¹ÛŒØª Ø¯Ø± Ù…ØªÙ† | Ø§Ø·Ù…ÛŒÙ†Ø§Ù† |
|---------|-----------|---------------------|---------------|---------|
| Ù†Ù‚Ø¯ÛŒÙ†Ú¯ÛŒ | "600 Ù…ÛŒÙ„ÛŒÙˆÙ†" | 600.0 | 12-25 | 0.95 |
| ÙˆØ§Ù… | "200 Ù…ÛŒÙ„ÛŒÙˆÙ†" | 200.0 | 45-60 | 0.90 |
| Ù¾Ø±Ø¯Ø§Ø®Øª Ù…Ø§Ù‡ÛŒØ§Ù†Ù‡ | "Ù…Ø§Ù‡ÛŒ 15 Ù…ÛŒÙ„ÛŒÙˆÙ†" | 15.0 | 250-265 | 0.85 |

### Ø®Ø±ÙˆØ¬ÛŒ Ù…Ø±Ø­Ù„Ù‡ 2

```json
{
  "entities": {
    "money_entities": [
      {
        "entity_type": "money",
        "value": 600.0,
        "confidence": 0.95,
        "start_pos": 12,
        "end_pos": 25,
        "raw_text": "600 Ù…ÛŒÙ„ÛŒÙˆÙ†"
      },
      {
        "entity_type": "money",
        "value": 200.0,
        "confidence": 0.90,
        "start_pos": 45,
        "end_pos": 60,
        "raw_text": "200 Ù…ÛŒÙ„ÛŒÙˆÙ†"
      },
      {
        "entity_type": "money",
        "value": 15.0,
        "confidence": 0.85,
        "start_pos": 250,
        "end_pos": 265,
        "raw_text": "Ù…Ø§Ù‡ÛŒ 15 Ù…ÛŒÙ„ÛŒÙˆÙ†"
      }
    ],
    "locations": ["ØªÙ‡Ø±Ø§Ù†", "Ø§Ú©Ø¨Ø§ØªØ§Ù†"],
    "loan_info": {
      "amount": 200.0,
      "availability_months": 2
    },
    "monthly_payment": 15.0,
    "search_type": {
      "type": "residential_rent",
      "search_type": "Ø±Ù‡Ù† Ú©Ø§Ù…Ù„",
      "is_rent": true,
      "is_purchase": false,
      "is_lease": false
    },
    "primary_liquidity": 600.0
  }
}
```

---

## ğŸ¯ Ù…Ø±Ø­Ù„Ù‡ 3: Ø·Ø¨Ù‚Ù‡â€ŒØ¨Ù†Ø¯ÛŒ Ù…Ù‚ØµÙˆØ¯

### Ú©Ù„Ø§Ø³: `IntentClassifier`

```python
# ÙØ§ÛŒÙ„: src/chatbot/intent_classifier.py

class IntentClassifier:
    def classify(self, text: str):
        # Step 3.1: Ø·Ø¨Ù‚Ù‡â€ŒØ¨Ù†Ø¯ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ Ú©Ù„Ù…Ø§Øª Ú©Ù„ÛŒØ¯ÛŒ
        keyword_scores = self.classify_by_keywords(text)
        # Result: [("search", 0.85), ("advice", 0.45)]
        
        # Step 3.2: Ø·Ø¨Ù‚Ù‡â€ŒØ¨Ù†Ø¯ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø§Ù„Ú¯ÙˆÙ‡Ø§
        pattern_scores = self.classify_by_patterns(text)
        # Result: [("search", 0.90)]
        
        # Step 3.3: ØªØ±Ú©ÛŒØ¨ Ù†ØªØ§ÛŒØ¬
        final_intent, confidence = self._merge_scores(keyword_scores, pattern_scores)
        # Result: ("search", 0.92)
```

### ØªØ­Ù„ÛŒÙ„ Ú©Ù„Ù…Ø§Øª Ú©Ù„ÛŒØ¯ÛŒ

| Ú©Ù„Ù…Ù‡ Ú©Ù„ÛŒØ¯ÛŒ | Ù†ÙˆØ¹ Ù…Ù‚ØµÙˆØ¯ | Ø§Ù…ØªÛŒØ§Ø² |
|------------|-----------|--------|
| "Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡Ù…" | SEARCH | 0.3 |
| "Ø¨Ø±Ø±Ø³ÛŒ" | SEARCH | 0.2 |
| "Ù¾ÛŒØ¯Ø§ Ú©Ù†Ù…" | SEARCH | 0.25 |
| "Ú†Ø·ÙˆØ±" | ADVICE | 0.15 |
| "Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ù…" | CALCULATE | 0.1 |

### Ø®Ø±ÙˆØ¬ÛŒ Ù…Ø±Ø­Ù„Ù‡ 3

```json
{
  "intent": "search",
  "confidence": 0.92,
  "requires_clarification": false,
  "classification_details": {
    "keyword_score": 0.85,
    "pattern_score": 0.90,
    "final_score": 0.92
  }
}
```

---

## ğŸ—ï¸ Ù…Ø±Ø­Ù„Ù‡ 4: ØªÙˆÙ„ÛŒØ¯ Ú©ÙˆØ¦Ø±ÛŒ Ø³Ø§Ø®ØªØ§Ø±ÛŒØ§ÙØªÙ‡

### Ú©Ù„Ø§Ø³: `NLUProcessor`

```python
# ÙØ§ÛŒÙ„: src/chatbot/nlu.py

class NLUProcessor:
    def process(self, text: str, context: dict = None):
        # Step 4.1: Ø³Ø§Ø®Øª UserProfile
        user_profile = self.entity_extractor.build_user_profile(entities)
        # Result: UserProfile(liquidity=600, loan_amount=200, ...)
        
        # Step 4.2: Ø³Ø§Ø®Øª SearchGoals
        search_goals = self.entity_extractor.build_search_goals(entities, user_profile)
        # Result: [Goal1, Goal2, Goal3]
        
        # Step 4.3: Ù…Ø­Ø§Ø³Ø¨Ù‡ confidence
        overall_confidence = self._calculate_confidence(...)
        # Result: 0.88
```

### Ø³Ø§Ø®Øª UserProfile

```json
{
  "user_profile": {
    "liquidity": 600000000.0,
    "loan_amount": 200000000.0,
    "loan_availability_months": 2,
    "max_monthly_payment": 15000000.0,
    "existing_obligations": 0.0,
    "total_budget": 800000000.0,
    "effective_monthly_budget": 15000000.0
  }
}
```

### Ø³Ø§Ø®Øª SearchGoals

```json
{
  "search_goals": [
    {
      "goal_id": 1,
      "type": "residential_rent",
      "target_location": "ØªÙ‡Ø±Ø§Ù†ØŒ Ø§Ú©Ø¨Ø§ØªØ§Ù†",
      "budget_source": "liquidity + loan",
      "priority": "high",
      "search_type": "Ø±Ù‡Ù† Ú©Ø§Ù…Ù„",
      "max_price": 800000000.0,
      "max_monthly_lease_payment": null,
      "additional_filters": {}
    },
    {
      "goal_id": 2,
      "type": "residential_rent",
      "target_location": "ØªÙ‡Ø±Ø§Ù†ØŒ Ù…Ù†Ø·Ù‚Ù‡ Ù…Ù†Ø§Ø³Ø¨ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ",
      "budget_source": "liquidity + loan",
      "priority": "medium",
      "search_type": "Ø±Ù‡Ù† Ú©Ø§Ù…Ù„",
      "max_price": 800000000.0,
      "max_monthly_lease_payment": null,
      "additional_filters": {}
    },
    {
      "goal_id": 3,
      "type": "vehicle_purchase_or_lease",
      "target_location": "Any",
      "budget_source": "liquidity",
      "max_monthly_lease_payment": 15000000.0,
      "priority": "high",
      "search_type": "Ø®Ø±ÛŒØ¯ ÛŒØ§ Ù„ÛŒØ²ÛŒÙ†Ú¯",
      "max_price": 800000000.0,
      "additional_filters": {}
    }
  ],
  "is_multi_goal": true
}
```

### Ú©Ù„Ø§Ø³: `QueryGenerator`

```python
# ÙØ§ÛŒÙ„: src/chatbot/query_generator.py

class QueryGenerator:
    def generate_queries(self, structured_query: StructuredQuery):
        # Step 4.4: Ø¨Ø±Ø§ÛŒ Ù‡Ø± goalØŒ Ú©ÙˆØ¦Ø±ÛŒâ€ŒÙ‡Ø§ÛŒ Ø³Ø§ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù ØªÙˆÙ„ÛŒØ¯ Ù…ÛŒâ€ŒØ´ÙˆØ¯
        
        # Goal 1: Ø±Ù‡Ù† Ø§Ú©Ø¨Ø§ØªØ§Ù†
        # - Divar: apartment-rent, location=Ø§Ú©Ø¨Ø§ØªØ§Ù†, price_max=800
        # - Sheypoor: apartment-rent, location=Ø§Ú©Ø¨Ø§ØªØ§Ù†, price_max=800
        
        # Goal 3: Ø®ÙˆØ¯Ø±Ùˆ
        # - Bama: search_type=purchase, price_max=800
        # - Torob: product_name=Ø®ÙˆØ¯Ø±Ùˆ, price_max=800
```

### Ø®Ø±ÙˆØ¬ÛŒ Query Generator

```json
{
  "queries": [
    {
      "site": "divar",
      "goal_id": 1,
      "search_type": "rent",
      "filters": {
        "category": "apartment-rent",
        "location": "ØªÙ‡Ø±Ø§Ù†ØŒ Ø§Ú©Ø¨Ø§ØªØ§Ù†",
        "price_max": 800,
        "price_min": 640,
        "rent_type": "full_deposit"
      },
      "priority": 3,
      "metadata": {
        "goal_type": "residential_rent",
        "target_location": "ØªÙ‡Ø±Ø§Ù†ØŒ Ø§Ú©Ø¨Ø§ØªØ§Ù†",
        "budget_source": "liquidity + loan"
      }
    },
    {
      "site": "sheypoor",
      "goal_id": 1,
      "search_type": "rent",
      "filters": {
        "category": "apartment-rent",
        "location": "ØªÙ‡Ø±Ø§Ù†ØŒ Ø§Ú©Ø¨Ø§ØªØ§Ù†",
        "price_max": 800,
        "price_min": 640
      },
      "priority": 3,
      "metadata": {
        "goal_type": "residential_rent",
        "target_location": "ØªÙ‡Ø±Ø§Ù†ØŒ Ø§Ú©Ø¨Ø§ØªØ§Ù†",
        "budget_source": "liquidity + loan"
      }
    },
    {
      "site": "torob",
      "goal_id": 3,
      "search_type": "general",
      "filters": {
        "product_name": "Ú¯ÙˆØ´ÛŒ Ù…ÙˆØ¨Ø§ÛŒÙ„",
        "price_max": 60,
        "price_min": 40
      },
      "priority": 3,
      "metadata": {
        "goal_type": "electronics",
        "target_location": "Any",
        "budget_source": "liquidity"
      }
    }
  ],
  "total_queries": 5,
  "sites": ["divar", "sheypoor", "bama", "torob", "digikala"]
}
```

---

## ğŸ•·ï¸ Ù…Ø±Ø­Ù„Ù‡ 5: Ø§Ø¬Ø±Ø§ÛŒ Ø®Ø²Ù†Ø¯Ù‡

### Ú©Ù„Ø§Ø³: `CrawlerManager`

```python
# ÙØ§ÛŒÙ„: src/crawler/crawler_manager.py

class CrawlerManager:
    def crawl_from_query_json(self, query_json: dict):
        # Step 5.1: ØªØ¨Ø¯ÛŒÙ„ Ú©ÙˆØ¦Ø±ÛŒâ€ŒÙ‡Ø§ Ø¨Ù‡ ÙØ±Ù…Øª Ø®Ø²Ù†Ø¯Ù‡
        crawl_queries = self._convert_queries(query_json)
        
        # Step 5.2: Ø§Ø¬Ø±Ø§ÛŒ Ù…ÙˆØ§Ø²ÛŒ Ø®Ø²Ù†Ø¯Ù‡â€ŒÙ‡Ø§
        batch_result = self.crawl_batch(crawl_queries, parallel=True)
        
        # Step 5.3: Ù†Ø±Ù…Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Ù†ØªØ§ÛŒØ¬
        normalized = self.normalizer.normalize_batch(batch_result)
```

### Ø§Ø¬Ø±Ø§ÛŒ Ø®Ø²Ù†Ø¯Ù‡ Torob (Ù…Ø«Ø§Ù„)

#### Ú©Ù„Ø§Ø³: `TorobCrawler`

```python
# ÙØ§ÛŒÙ„: src/crawler/torob_crawler.py

class TorobCrawler(BaseCrawler):
    def build_search_url(self, filters: dict):
        # Step 5.1.1: Ø³Ø§Ø®Øª URL
        product_name = filters.get('product_name', 'Ú¯ÙˆØ´ÛŒ Ù…ÙˆØ¨Ø§ÛŒÙ„')
        price_max = filters.get('price_max', 60)
        
        url = f"https://torob.com/search/{product_name}"
        url += f"?price-max={int(price_max * 1000000)}"
        
        return url
    
    def extract_items(self, html_content: str):
        # Step 5.1.2: Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ Ø§Ø² HTML
        soup = BeautifulSoup(html_content, 'html.parser')
        product_cards = soup.find_all('div', class_='product-card')
        
        items = []
        for card in product_cards:
            # Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù‡Ø± Ù…Ø­ØµÙˆÙ„
            item = {
                'title': extract_title(card),
                'price': extract_price(card),
                'url': extract_url(card),
                'image': extract_image(card),
                ...
            }
            items.append(item)
        
        return items
```

### Ø¬Ø²Ø¦ÛŒØ§Øª Ø§Ø¬Ø±Ø§ÛŒ Ø®Ø²Ù†Ø¯Ù‡ Torob

#### URL ØªÙˆÙ„ÛŒØ¯ Ø´Ø¯Ù‡:
```
https://torob.com/search/Ú¯ÙˆØ´ÛŒ-Ù…ÙˆØ¨Ø§ÛŒÙ„?price-max=60000000&price-min=40000000
```

#### Ø§Ù„Ú¯ÙˆÛŒ HTML Ù…ÙˆØ±Ø¯ Ø§Ø³ØªÙØ§Ø¯Ù‡:
```html
<div class="product-card">
    <h3 class="product-title">
        <a href="/product/123456">Ú¯ÙˆØ´ÛŒ Ø³Ø§Ù…Ø³ÙˆÙ†Ú¯ Galaxy S23</a>
    </h3>
    <div class="product-price">55,000,000 ØªÙˆÙ…Ø§Ù†</div>
    <img src="https://torob.com/images/product.jpg" />
</div>
```

#### Ù†ØªØ§ÛŒØ¬ Ø§Ø³ØªØ®Ø±Ø§Ø¬ (100 Ø¢ÛŒØªÙ…):

```json
{
  "success": true,
  "site_name": "torob",
  "items": [
    {
      "item_id": "torob_123456",
      "source_site": "torob",
      "title": "Ú¯ÙˆØ´ÛŒ Ù…ÙˆØ¨Ø§ÛŒÙ„ Ø³Ø§Ù…Ø³ÙˆÙ†Ú¯ Galaxy S23 Ultra 256GB",
      "description": "Ú¯ÙˆØ´ÛŒ Ø³Ø§Ù…Ø³ÙˆÙ†Ú¯ Ú¯Ù„Ú©Ø³ÛŒ S23 Ø§ÙˆÙ„ØªØ±Ø§ Ø¨Ø§ Ø­Ø§ÙØ¸Ù‡ 256 Ú¯ÛŒÚ¯Ø§Ø¨Ø§ÛŒØª",
      "url": "https://torob.com/product/123456",
      "price": 55.5,
      "price_text": "55,500,000 ØªÙˆÙ…Ø§Ù†",
      "price_type": "Ù†Ù‚Ø¯ÛŒ",
      "location": null,
      "city": null,
      "district": null,
      "images": [
        "https://torob.com/images/product-123456-1.jpg",
        "https://torob.com/images/product-123456-2.jpg"
      ],
      "thumbnail": "https://torob.com/images/product-123456-thumb.jpg",
      "properties": {
        "product_type": "electronics",
        "brand": "Samsung",
        "model": "Galaxy S23 Ultra",
        "storage": "256GB",
        "color": "Black",
        "raw_data": {
          "original_html": "...",
          "extracted_fields": {...}
        }
      },
      "crawled_at": "2024-11-15T10:35:23.456789",
      "goal_id": 3,
      "search_query": {
        "site": "torob",
        "filters": {
          "product_name": "Ú¯ÙˆØ´ÛŒ Ù…ÙˆØ¨Ø§ÛŒÙ„",
          "price_max": 60,
          "price_min": 40
        }
      },
      "confidence_score": 0.85,
      "completeness_score": 0.92
    },
    {
      "item_id": "torob_123457",
      "source_site": "torob",
      "title": "Ú¯ÙˆØ´ÛŒ Ù…ÙˆØ¨Ø§ÛŒÙ„ Ø§Ù¾Ù„ iPhone 14 Pro 256GB",
      "description": "Ú¯ÙˆØ´ÛŒ Ø§Ù¾Ù„ Ø¢ÛŒÙÙˆÙ† 14 Ù¾Ø±Ùˆ Ø¨Ø§ Ø­Ø§ÙØ¸Ù‡ 256 Ú¯ÛŒÚ¯Ø§Ø¨Ø§ÛŒØª",
      "url": "https://torob.com/product/123457",
      "price": 58.2,
      "price_text": "58,200,000 ØªÙˆÙ…Ø§Ù†",
      "price_type": "Ù†Ù‚Ø¯ÛŒ",
      "images": [
        "https://torob.com/images/product-123457-1.jpg"
      ],
      "thumbnail": "https://torob.com/images/product-123457-thumb.jpg",
      "properties": {
        "product_type": "electronics",
        "brand": "Apple",
        "model": "iPhone 14 Pro",
        "storage": "256GB",
        "color": "Deep Purple"
      },
      "crawled_at": "2024-11-15T10:35:24.123456",
      "goal_id": 3,
      "confidence_score": 0.88,
      "completeness_score": 0.95
    }
    // ... 98 Ø¢ÛŒØªÙ… Ø¯ÛŒÚ¯Ø±
  ],
  "total_items": 100,
  "execution_time": 12.45,
  "errors": []
}
```

### Ø¢Ù…Ø§Ø± Ø§Ø¬Ø±Ø§ÛŒ Ø®Ø²Ù†Ø¯Ù‡

| Ø³Ø§ÛŒØª | ØªØ¹Ø¯Ø§Ø¯ Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ | Ø²Ù…Ø§Ù† Ø§Ø¬Ø±Ø§ (Ø«Ø§Ù†ÛŒÙ‡) | Ø®Ø·Ø§Ù‡Ø§ | Ù…ÙˆÙÙ‚ÛŒØª |
|------|---------------|-------------------|-------|--------|
| Torob | 100 | 12.45 | 0 | âœ… |
| Divar | 45 | 18.32 | 0 | âœ… |
| Sheypoor | 38 | 15.67 | 1 | âœ… |
| Bama | 52 | 20.11 | 0 | âœ… |
| Digikala | 67 | 14.89 | 0 | âœ… |
| **Ù…Ø¬Ù…ÙˆØ¹** | **302** | **81.44** | **1** | **âœ…** |

---

## ğŸ”„ Ù…Ø±Ø­Ù„Ù‡ 6: Ù†Ø±Ù…Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§

### Ú©Ù„Ø§Ø³: `DataNormalizer`

```python
# ÙØ§ÛŒÙ„: src/crawler/data_normalizer.py

class DataNormalizer:
    def normalize_batch(self, batch_result: CrawlBatchResult):
        # Step 6.1: Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ Ù‡Ù…Ù‡ Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§
        all_items = collect_all_items(batch_result)
        
        # Step 6.2: Ø­Ø°Ù ØªÚ©Ø±Ø§Ø±ÛŒâ€ŒÙ‡Ø§
        unique_items = remove_duplicates(all_items)
        
        # Step 6.3: Ù†Ø±Ù…Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Ù‡Ø± Ø¢ÛŒØªÙ…
        normalized_items = []
        for item in unique_items:
            normalized = self._normalize_item(item)
            normalized_items.append(normalized)
        
        # Step 6.4: Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ Ú©ÛŒÙÛŒØª
        normalized_items.sort(key=lambda x: (
            x['confidence_score'],
            x['completeness_score']
        ), reverse=True)
```

### Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø§Ù…ØªÛŒØ§Ø² Ú©Ø§Ù…Ù„â€ŒØ¨ÙˆØ¯Ù† (Completeness Score)

```python
def _calculate_completeness(self, item: CrawledItem) -> float:
    score = 0.0
    max_score = 10.0
    
    # ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ø§Ø¬Ø¨Ø§Ø±ÛŒ
    if item.title: score += 1.0      # 10%
    if item.url: score += 1.0        # 10%
    if item.price or item.price_text: score += 1.5  # 15%
    
    # ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ù…Ù‡Ù…
    if item.location: score += 1.0   # 10%
    if item.images: score += 1.0      # 10%
    if item.description: score += 0.5  # 5%
    
    # ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ø§Ø¶Ø§ÙÛŒ
    if item.city: score += 0.5        # 5%
    if item.district: score += 0.5    # 5%
    if item.properties: score += 1.0  # 10%
    
    return min(score / max_score, 1.0)
```

### Ù†ØªØ§ÛŒØ¬ Ù†Ø±Ù…Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ

```json
{
  "normalization_stats": {
    "total_items_before": 302,
    "duplicates_removed": 12,
    "total_items_after": 290,
    "normalization_time": 0.45
  },
  "quality_distribution": {
    "high_quality": 245,
    "medium_quality": 38,
    "low_quality": 7
  }
}
```

---

## ğŸ“Š Ù†ØªØ§ÛŒØ¬ Ù†Ù‡Ø§ÛŒÛŒ

### Ø³Ø§Ø®ØªØ§Ø± JSON Ú©Ø§Ù…Ù„ (100 Ø¢ÛŒØªÙ… Ø§Ø² Torob)

```json
{
  "success": true,
  "total_items": 100,
  "items": [
    {
      "item_id": "torob_123456",
      "source_site": "torob",
      "title": "Ú¯ÙˆØ´ÛŒ Ù…ÙˆØ¨Ø§ÛŒÙ„ Ø³Ø§Ù…Ø³ÙˆÙ†Ú¯ Galaxy S23 Ultra 256GB",
      "description": "Ú¯ÙˆØ´ÛŒ Ø³Ø§Ù…Ø³ÙˆÙ†Ú¯ Ú¯Ù„Ú©Ø³ÛŒ S23 Ø§ÙˆÙ„ØªØ±Ø§ Ø¨Ø§ Ø­Ø§ÙØ¸Ù‡ 256 Ú¯ÛŒÚ¯Ø§Ø¨Ø§ÛŒØªØŒ Ø¯ÙˆØ±Ø¨ÛŒÙ† 200 Ù…Ú¯Ø§Ù¾ÛŒÚ©Ø³Ù„ØŒ Ù¾Ø±Ø¯Ø§Ø²Ù†Ø¯Ù‡ Snapdragon 8 Gen 2",
      "url": "https://torob.com/product/123456",
      "price": 55.5,
      "price_text": "55,500,000 ØªÙˆÙ…Ø§Ù†",
      "price_type": "Ù†Ù‚Ø¯ÛŒ",
      "images": [
        "https://torob.com/images/product-123456-1.jpg",
        "https://torob.com/images/product-123456-2.jpg",
        "https://torob.com/images/product-123456-3.jpg"
      ],
      "thumbnail": "https://torob.com/images/product-123456-thumb.jpg",
      "properties": {
        "product_type": "electronics",
        "category": "Ú¯ÙˆØ´ÛŒ Ù…ÙˆØ¨Ø§ÛŒÙ„",
        "brand": "Samsung",
        "model": "Galaxy S23 Ultra",
        "storage": "256GB",
        "ram": "12GB",
        "color": "Black",
        "screen_size": "6.8 Ø§ÛŒÙ†Ú†",
        "camera": "200MP",
        "battery": "5000mAh",
        "os": "Android 13",
        "warranty": "12 Ù…Ø§Ù‡",
        "seller": "ÙØ±ÙˆØ´Ú¯Ø§Ù‡ ØªÚ©Ù†ÙˆÙ„Ø§ÛŒÙ",
        "seller_rating": 4.8,
        "raw_data": {
          "original_html_snippet": "...",
          "extraction_method": "css_selectors",
          "extraction_timestamp": "2024-11-15T10:35:23"
        }
      },
      "crawled_at": "2024-11-15T10:35:23.456789",
      "goal_id": 3,
      "search_query": {
        "site": "torob",
        "filters": {
          "product_name": "Ú¯ÙˆØ´ÛŒ Ù…ÙˆØ¨Ø§ÛŒÙ„",
          "price_max": 60,
          "price_min": 40
        },
        "goal_id": 3
      },
      "confidence_score": 0.92,
      "completeness_score": 0.95
    }
    // ... 99 Ø¢ÛŒØªÙ… Ø¯ÛŒÚ¯Ø±
  ],
  "sources": ["torob"],
  "timestamp": "2024-11-15T10:36:00.123456",
  "metadata": {
    "normalization_applied": true,
    "duplicates_removed": 0,
    "execution_time": 12.45,
    "crawler_version": "1.0.0",
    "processing_steps": [
      "entity_extraction",
      "intent_classification",
      "query_generation",
      "crawling",
      "normalization"
    ]
  }
}
```

### Ø¢Ù…Ø§Ø± Ú©Ù„ÛŒ Ù†ØªØ§ÛŒØ¬

| Ù…Ø¹ÛŒØ§Ø± | Ù…Ù‚Ø¯Ø§Ø± |
|-------|-------|
| Ú©Ù„ Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ ÛŒØ§ÙØª Ø´Ø¯Ù‡ | 302 |
| Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ù†Ø±Ù…Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Ø´Ø¯Ù‡ | 290 |
| Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ø­Ø°Ù Ø´Ø¯Ù‡ (ØªÚ©Ø±Ø§Ø±ÛŒ) | 12 |
| Ø²Ù…Ø§Ù† Ú©Ù„ Ù¾Ø±Ø¯Ø§Ø²Ø´ | 94.34 Ø«Ø§Ù†ÛŒÙ‡ |
| Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† confidence score | 0.87 |
| Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† completeness score | 0.91 |
| Ø³Ø§ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø¬Ø³ØªØ¬Ùˆ Ø´Ø¯Ù‡ | 5 |
| Ø§Ù‡Ø¯Ø§Ù Ø¬Ø³ØªØ¬Ùˆ | 3 |

---

## ğŸ“ˆ Ù†Ù…ÙˆØ¯Ø§Ø± Ø¬Ø±ÛŒØ§Ù† Ú©Ø§Ù…Ù„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    USER INPUT (287 characters)                  â”‚
â”‚  "Ø³Ù„Ø§Ù… Ù…Ù† 600 Ù…ÛŒÙ„ÛŒÙˆÙ† Ù†Ù‚Ø¯ Ø¯Ø§Ø±Ù… Ùˆ Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ù… 200 Ù…ÛŒÙ„ÛŒÙˆÙ† Ù‡Ù…        â”‚
â”‚   ÙˆØ§Ù… Ø¨Ú¯ÛŒØ±Ù… ØªØ§ 2 Ù…Ø§Ù‡ Ø¢ÛŒÙ†Ø¯Ù‡ Ø¨Ù‡ Ø¯Ø³ØªÙ… Ø¨Ø±Ø³Ø¯. Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡Ù… Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†Ù…   â”‚
â”‚   Ø¨Ø§ Ø§ÛŒÙ† Ù…Ø¨Ù„Øº Ø®Ø§Ù†Ù‡ Ø¯Ø± ØªÙ‡Ø±Ø§Ù† Ø§Ú©Ø¨Ø§ØªØ§Ù† Ø±Ù‡Ù† Ú©Ù†Ù…..."                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ChatbotEngine.process_message()              â”‚
â”‚  - Ø¯Ø±ÛŒØ§ÙØª Ù¾ÛŒØ§Ù…                                                   â”‚
â”‚  - Ù…Ø¯ÛŒØ±ÛŒØª session                                                â”‚
â”‚  - Ø§Ø³ØªØ®Ø±Ø§Ø¬ context                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    NLUProcessor.process()                      â”‚
â”‚  Step 1: EntityExtractor.extract_all_entities()                â”‚
â”‚    â”œâ”€ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…ÙˆØ¬ÙˆØ¯ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ù¾ÙˆÙ„ÛŒ: [600M, 200M, 15M]              â”‚
â”‚    â”œâ”€ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…Ú©Ø§Ù†â€ŒÙ‡Ø§: ["ØªÙ‡Ø±Ø§Ù†", "Ø§Ú©Ø¨Ø§ØªØ§Ù†"]                   â”‚
â”‚    â”œâ”€ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ø·Ù„Ø§Ø¹Ø§Øª ÙˆØ§Ù…: {amount: 200M, months: 2}           â”‚
â”‚    â””â”€ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù†ÙˆØ¹ Ø¬Ø³ØªØ¬Ùˆ: {type: "residential_rent"}            â”‚
â”‚                                                                 â”‚
â”‚  Step 2: IntentClassifier.classify()                           â”‚
â”‚    â””â”€ Intent: SEARCH, Confidence: 0.92                         â”‚
â”‚                                                                 â”‚
â”‚  Step 3: build_user_profile()                                   â”‚
â”‚    â””â”€ UserProfile: {liquidity: 600M, loan: 200M, ...}         â”‚
â”‚                                                                 â”‚
â”‚  Step 4: build_search_goals()                                  â”‚
â”‚    â””â”€ SearchGoals: [Goal1, Goal2, Goal3]                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    StructuredQuery Generated                    â”‚
â”‚  {                                                              â”‚
â”‚    "user_profile": {...},                                       â”‚
â”‚    "search_goals": [                                            â”‚
â”‚      {goal_id: 1, type: "residential_rent", location: "..."},  â”‚
â”‚      {goal_id: 2, type: "residential_rent", location: "..."},  â”‚
â”‚      {goal_id: 3, type: "vehicle", ...}                         â”‚
â”‚    ]                                                             â”‚
â”‚  }                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    QueryGenerator.generate_queries()            â”‚
â”‚  - ØªÙˆÙ„ÛŒØ¯ 5 Ú©ÙˆØ¦Ø±ÛŒ Ø¨Ø±Ø§ÛŒ 5 Ø³Ø§ÛŒØª Ù…Ø®ØªÙ„Ù                              â”‚
â”‚  - ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡ ÙØ±Ù…Øª Ù‚Ø§Ø¨Ù„ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ Ø®Ø²Ù†Ø¯Ù‡                        â”‚
â”‚  - Ø§ÙˆÙ„ÙˆÛŒØªâ€ŒØ¨Ù†Ø¯ÛŒ Ú©ÙˆØ¦Ø±ÛŒâ€ŒÙ‡Ø§                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CrawlerManager.crawl_batch()                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ DivarCrawler â”‚  â”‚SheypoorCrawlerâ”‚  â”‚ TorobCrawler  â”‚        â”‚
â”‚  â”‚   (45 items) â”‚  â”‚  (38 items)  â”‚  â”‚ (100 items)   â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚  â”‚ BamaCrawler  â”‚  â”‚DigikalaCrawlerâ”‚                            â”‚
â”‚  â”‚  (52 items)  â”‚  â”‚  (67 items)   â”‚                            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â”‚  Total: 302 items, Time: 81.44s                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DataNormalizer.normalize_batch()              â”‚
â”‚  - Ø­Ø°Ù ØªÚ©Ø±Ø§Ø±ÛŒâ€ŒÙ‡Ø§: 12 Ø¢ÛŒØªÙ…                                        â”‚
â”‚  - Ù†Ø±Ù…Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ: 290 Ø¢ÛŒØªÙ…                                         â”‚
â”‚  - Ù…Ø­Ø§Ø³Ø¨Ù‡ Ú©ÛŒÙÛŒØª: confidence & completeness                      â”‚
â”‚  - Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ: Ø¨Ø± Ø§Ø³Ø§Ø³ Ú©ÛŒÙÛŒØª                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FINAL RESULTS (JSON)                         â”‚
â”‚  {                                                              â”‚
â”‚    "success": true,                                             â”‚
â”‚    "total_items": 290,                                          â”‚
â”‚    "items": [...],                                              â”‚
â”‚    "sources": ["divar", "sheypoor", "bama", "torob", "digikala"],â”‚
â”‚    "metadata": {...}                                            â”‚
â”‚  }                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ Ø¬Ø²Ø¦ÛŒØ§Øª ÙÙ†ÛŒ Ú©Ù„Ø§Ø³â€ŒÙ‡Ø§

### Ú©Ù„Ø§Ø³ ChatbotEngine

```python
class ChatbotEngine:
    """
    Ù…ÙˆØªÙˆØ± Ø§ØµÙ„ÛŒ Ú†Øªâ€ŒØ¨Ø§Øª
    
    Attributes:
        nlu_processor: Ù¾Ø±Ø¯Ø§Ø²Ø´Ú¯Ø± Ø²Ø¨Ø§Ù† Ø·Ø¨ÛŒØ¹ÛŒ
        query_generator: ØªÙˆÙ„ÛŒØ¯Ú©Ù†Ù†Ø¯Ù‡ Ú©ÙˆØ¦Ø±ÛŒ
        conversation_history: ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ù…Ú©Ø§Ù„Ù…Ø§Øª
    
    Methods:
        process_message(): Ù¾Ø±Ø¯Ø§Ø²Ø´ Ù¾ÛŒØ§Ù… Ú©Ø§Ø±Ø¨Ø±
        clear_session(): Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† session
        get_conversation_summary(): Ø¯Ø±ÛŒØ§ÙØª Ø®Ù„Ø§ØµÙ‡ Ù…Ú©Ø§Ù„Ù…Ù‡
    """
```

### Ú©Ù„Ø§Ø³ EntityExtractor

```python
class EntityExtractor:
    """
    Ø§Ø³ØªØ®Ø±Ø§Ø¬â€ŒÚ©Ù†Ù†Ø¯Ù‡ Ù…ÙˆØ¬ÙˆØ¯ÛŒØªâ€ŒÙ‡Ø§
    
    Methods:
        extract_money_entities(): Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…ÙˆØ¬ÙˆØ¯ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ù¾ÙˆÙ„ÛŒ
        extract_loan_info(): Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ø·Ù„Ø§Ø¹Ø§Øª ÙˆØ§Ù…
        extract_location(): Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…Ú©Ø§Ù†â€ŒÙ‡Ø§
        extract_search_type(): Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù†ÙˆØ¹ Ø¬Ø³ØªØ¬Ùˆ
        extract_all_entities(): Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù‡Ù…Ù‡ Ù…ÙˆØ¬ÙˆØ¯ÛŒØªâ€ŒÙ‡Ø§
        build_user_profile(): Ø³Ø§Ø®Øª Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ú©Ø§Ø±Ø¨Ø±
        build_search_goals(): Ø³Ø§Ø®Øª Ø§Ù‡Ø¯Ø§Ù Ø¬Ø³ØªØ¬Ùˆ
    """
```

### Ú©Ù„Ø§Ø³ TorobCrawler

```python
class TorobCrawler(BaseCrawler):
    """
    Ø®Ø²Ù†Ø¯Ù‡ Ø³Ø§ÛŒØª Torob
    
    Inherits:
        BaseCrawler: Ú©Ù„Ø§Ø³ Ù¾Ø§ÛŒÙ‡ Ø®Ø²Ù†Ø¯Ù‡
    
    Methods:
        build_search_url(): Ø³Ø§Ø®Øª URL Ø¬Ø³ØªØ¬Ùˆ
        extract_items(): Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ Ø§Ø² HTML
        normalize_item(): Ù†Ø±Ù…Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Ø¢ÛŒØªÙ…
    """
```

---

## ğŸ“ Ø®Ù„Ø§ØµÙ‡

Ø§ÛŒÙ† Ù…Ø³ØªÙ†Ø¯Ø§Øª Ù†Ø´Ø§Ù† Ù…ÛŒâ€ŒØ¯Ù‡Ø¯ Ú©Ù‡ Ú†Ú¯ÙˆÙ†Ù‡ Ø³ÛŒØ³ØªÙ… SEDE:

1. âœ… Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ù¾ÛŒÚ†ÛŒØ¯Ù‡ Ú©Ø§Ø±Ø¨Ø± Ø±Ø§ Ø¯Ø±Ú© Ù…ÛŒâ€ŒÚ©Ù†Ø¯
2. âœ… Ù…ÙˆØ¬ÙˆØ¯ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ù…Ù‡Ù… Ø±Ø§ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…ÛŒâ€ŒÚ©Ù†Ø¯
3. âœ… Ù…Ù‚ØµÙˆØ¯ Ú©Ø§Ø±Ø¨Ø± Ø±Ø§ ØªØ´Ø®ÛŒØµ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯
4. âœ… Ú©ÙˆØ¦Ø±ÛŒâ€ŒÙ‡Ø§ÛŒ Ø³Ø§Ø®ØªØ§Ø±ÛŒØ§ÙØªÙ‡ ØªÙˆÙ„ÛŒØ¯ Ù…ÛŒâ€ŒÚ©Ù†Ø¯
5. âœ… Ø§Ø² Ú†Ù†Ø¯ÛŒÙ† Ø³Ø§ÛŒØª Ø¨Ù‡ ØµÙˆØ±Øª Ù…ÙˆØ§Ø²ÛŒ Ø¯Ø§Ø¯Ù‡ Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ Ù…ÛŒâ€ŒÚ©Ù†Ø¯
6. âœ… Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø±Ø§ Ù†Ø±Ù…Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Ùˆ ÛŒÚ©Ù¾Ø§Ø±Ú†Ù‡ Ù…ÛŒâ€ŒÚ©Ù†Ø¯
7. âœ… Ù†ØªØ§ÛŒØ¬ Ø¨Ø§ Ú©ÛŒÙÛŒØª Ø±Ø§ Ø¨Ù‡ ØµÙˆØ±Øª JSON Ø¨Ø±Ù…ÛŒâ€ŒÚ¯Ø±Ø¯Ø§Ù†Ø¯

ØªÙ…Ø§Ù… Ø§ÛŒÙ† ÙØ±Ø¢ÛŒÙ†Ø¯ Ø¨Ù‡ ØµÙˆØ±Øª Ø®ÙˆØ¯Ú©Ø§Ø± Ùˆ Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ù…Ø¹Ù…Ø§Ø±ÛŒ Ø´ÛŒâ€ŒÚ¯Ø±Ø§ Ùˆ Ù‚Ø§Ø¨Ù„ Ú¯Ø³ØªØ±Ø´ Ø§Ù†Ø¬Ø§Ù… Ù…ÛŒâ€ŒØ´ÙˆØ¯.

</div>

